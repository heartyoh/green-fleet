-- vehicle group
CREATE TABLE vehicle_group (
	company VARCHAR(50) NOT NULL, 
	id VARCHAR(50) NOT NULL, 
	expl VARCHAR(2000), 
	created_at DATETIME, 
	updated_at DATETIME, 
	PRIMARY KEY(company, id)
) DEFAULT CHARSET=utf8;

-- vehicle relation
CREATE TABLE vehicle_relation (
	company VARCHAR(50) NOT NULL, 
	vehicle_id VARCHAR(50) NOT NULL, 
	group_id VARCHAR(50) NOT NULL, 
	PRIMARY KEY(company, vehicle_id, group_id)
) DEFAULT CHARSET=utf8;

-- driver group
CREATE TABLE driver_group (
	company VARCHAR(50) NOT NULL, 
	id VARCHAR(50) NOT NULL, 
	expl VARCHAR(2000), 
	created_at DATETIME, 
	updated_at DATETIME, 
	PRIMARY KEY(company, id)
) DEFAULT CHARSET=utf8;

-- driver relation
CREATE TABLE driver_relation (
	company VARCHAR(50) NOT NULL, 
	driver_id VARCHAR(50) NOT NULL, 
	group_id VARCHAR(50) NOT NULL,
	PRIMARY KEY(company, driver_id, group_id)
) DEFAULT CHARSET=utf8;

-- location
CREATE TABLE location (
	company 	VARCHAR(50) NOT NULL, 
	name 		VARCHAR(100) NOT NULL, 
	addr 		VARCHAR(200),
	expl 		VARCHAR(2000),
	lat 		FLOAT(11,7) NOT NULL,
	lng 		FLOAT(11,7) NOT NULL,
	rad 		FLOAT(10,2) NOT NULL,
	lat_hi 		FLOAT(11,7) NOT NULL,
	lat_lo 		FLOAT(11,7) NOT NULL,
	lng_hi 		FLOAT(11,7) NOT NULL,
	lng_lo 		FLOAT(11,7) NOT NULL,
	created_at 	DATETIME, 
	updated_at 	DATETIME, 
	PRIMARY KEY(company, name)
) DEFAULT CHARSET=utf8;

-- alarm
CREATE TABLE alarm (
	company 	VARCHAR(50) NOT NULL, 
	name 		VARCHAR(100) NOT NULL,
	type 		VARCHAR(20) NOT NULL,
	evt_type 	VARCHAR(20) NOT NULL,
	evt_name 	VARCHAR(100) NOT NULL,
	evt_trg 	VARCHAR(20),
	from_date 	DATE,
	to_date 	DATE,
	always 		BIT(1) NOT NULL,
	enabled 	BIT(1) NOT NULL,
	dest		VARCHAR(4000) NOT NULL,	
	msg 		VARCHAR(4000),
	created_at 	DATETIME, 
	updated_at 	DATETIME, 
	PRIMARY KEY(company, name)
) DEFAULT CHARSET=utf8;

-- alarm & vehicles relation
CREATE TABLE alarm_vehicle_relation (
	company 	VARCHAR(50) NOT NULL, 
	alarm_name 	VARCHAR(100) NOT NULL, 
	vehicle_id 	VARCHAR(50) NOT NULL, 
	PRIMARY KEY(company, alarm_name, vehicle_id)
) DEFAULT CHARSET=utf8;

-- vehicle run sum
CREATE TABLE vehicle_run_sum (
	company VARCHAR(50) NOT NULL,
	vehicle VARCHAR(50) NOT NULL, 
	year SMALLINT NOT NULL, 
	month SMALLINT NOT NULL,
	month_date DATE NOT NULL,
	run_time INT,
	run_dist FLOAT(9,1),
	consmpt FLOAT(9,1),
	co2_emss FLOAT(7,2),
	effcc FLOAT(5,2),
	oos_cnt INT,
	mnt_cnt INT,
	mnt_time INT,
	PRIMARY KEY(company, vehicle, year, month)
) DEFAULT CHARSET=utf8;

-- driver run sum
CREATE TABLE driver_run_sum (
	company VARCHAR(50) NOT NULL,
	driver VARCHAR(50) NOT NULL, 
	year SMALLINT NOT NULL, 
	month SMALLINT NOT NULL,
	month_date DATE NOT NULL,
	run_time INT,
	run_dist FLOAT(9,1),
	consmpt FLOAT(9,1),
	co2_emss FLOAT(7,2),
	effcc FLOAT(5,2),
	sud_accel_cnt INT,
	sud_brake_cnt INT,
	eco_drv_time INT,
	ovr_spd_time INT,
	inc_cnt INT,
	spd_lt10 INT, 
	spd_lt20 INT, 
	spd_lt30 INT, 
	spd_lt40 INT, 
	spd_lt50 INT, 
	spd_lt60 INT, 
	spd_lt70 INT, 
	spd_lt80 INT, 
	spd_lt90 INT, 
	spd_lt100 INT, 
	spd_lt110 INT, 
	spd_lt120 INT, 
	spd_lt130 INT, 
	spd_lt140 INT, 
	spd_lt150 INT, 
	spd_lt160 INT,
	PRIMARY KEY(company, driver, year, month)
) DEFAULT CHARSET=utf8;

-- task
CREATE TABLE task (
	id BIGINT UNSIGNED AUTO_INCREMENT NOT NULL, 
	company VARCHAR(50) NOT NULL,
	title VARCHAR(100) NOT NULL,
	start_date DATETIME NOT NULL,
	end_date DATETIME NOT NULL,
	all_day BIT(1),
	category VARCHAR(20) NOT NULL,	
	reminder VARCHAR(50),
	notes VARCHAR(255),
	loc VARCHAR(255),
	url VARCHAR(400),
	rrule VARCHAR(20),
	PRIMARY KEY(id),
	INDEX task_idx1 (company, start_date, end_date) 
) DEFAULT CHARSET=utf8;